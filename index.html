<!DOCTYPE html>
<html>
<head>
  <title>Gioco Elementi Geometrici</title>
  <style>
    /* Stili per il container del gioco */
    body {
      margin: 0;
      padding: 0;
    }

    /* Stili per l'header */
    header {
      width: 100%;
      height: 50px;
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1;
    }

    /* Stili per il pulsante */
    #link-button {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 200px;
      height: 50px;
      background-color: red;
      color: white;
      font-size: 18px;
      border: none;
      border-radius: 5px;
      position: fixed;
      bottom: 10px;
      left: calc(50% - 100px);
      transition: background-color 0.3s ease;
    }

    #link-button.enabled {
      background-color: green;
      cursor: pointer;
    }

    /* Stili per il container dei cerchi */
    #game-container {
      width: 100%;
      height: calc(100vh - 60px);
      display: flex;
      justify-content: center;
      align-items: flex-end;
      background-color: black;
      position: relative;
      flex-wrap: wrap;
    }

    /* Stili per gli elementi geometrici */
    .shape {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      position: relative;
      cursor: pointer;
      transition: background-color 0.3s ease;
      border: 4px solid white;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Stili per il testo all'interno dei cerchi */
    .shape span {
      color: white;
      font-size: 24px;
    }
  </style>
</head>
<body>
  <header>
    <button id="link-button" disabled>vrchitect</button>
  </header>
  <div id="game-container"></div>

  <script>
    var isMusicPlaying = false;
    var letterIndex = 0;
    var expectedText = 'vrchitect';
    var shapesText = generateRandomLetters(expectedText);
    var isGameWon = false;

    // Funzione per generare una sequenza casuale di lettere
    function generateRandomLetters(expectedText) {
      var letters = expectedText.split('');
      var randomLetters = letters.slice();
      var randomIndex = Math.floor(Math.random() * randomLetters.length);
      randomLetters[randomIndex] = getRandomLetter(expectedText[letterIndex]);
      return randomLetters;
    }

    // Funzione per ottenere la lettera successiva
    function getNextLetter(currentLetter) {
      var alphabet = 'abcdefghijklmnopqrstuvwxyz'.toUpperCase();
      var currentIndex = alphabet.indexOf(currentLetter);
      var nextIndex = (currentIndex + 1) % alphabet.length;
      return alphabet[nextIndex];
    }

    // Funzione per generare un colore casuale in formato esadecimale
    function getRandomColor() {
      var letters = '0123456789ABCDEF';
      var color = '#';
      for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    // Funzione per ottenere una lettera casuale diversa da quella corretta
    function getRandomLetter(currentLetter) {
      var randomLetter = currentLetter;
      while (randomLetter.toUpperCase() === currentLetter.toUpperCase()) {
        randomLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
      }
      return randomLetter;
    }

    // Funzione per gestire il tocco sugli elementi geometrici
    function handleTouch(event) {
      if (isGameWon) {
        return;
      }

      var shape = event.target;

      if (!isMusicPlaying) {
        var audio = new Audio('Fotonovela.mp3');
        audio.play();
        isMusicPlaying = true;
      }

      var clickedLetter = shape.textContent.toUpperCase();

      if (clickedLetter === expectedText[letterIndex].toUpperCase()) {
        shape.style.backgroundColor = getRandomColor();
        shape.style.color = 'white';

        letterIndex++;

        if (letterIndex === expectedText.length) {
          isGameWon = true;

          var linkButton = document.getElementById('link-button');
          linkButton.classList.add('enabled');
          linkButton.disabled = false;
        }
        else {
          shapesText = generateRandomLetters(expectedText);
          updateShapes();
        }
      } else {
        shape.classList.add('wrong-letter');
        setTimeout(function() {
          shape.classList.remove('wrong-letter');
        }, 500);
      }
    }

    // Funzione per aprire il link
    function openLink() {
      if (isGameWon) {
        window.location.href = 'https://oncyber.io/spaces/DSUTHtsMOuAnVfZc67rI';
      }
    }

    // Funzione per creare gli elementi geometrici nel gioco
    function createShapes() {
      var gameContainer = document.getElementById('game-container');

      for (var i = 0; i < expectedText.length; i++) {
        var shape = document.createElement('div');
        shape.className = 'shape';
        shape.style.backgroundColor = getRandomColor();
        shape.style.color = 'white';

        var shapeText = document.createElement('span');
        shapeText.textContent = shapesText[i].toUpperCase();
        shape.appendChild(shapeText);

        shape.addEventListener('click', handleTouch);
        gameContainer.appendChild(shape);
      }
    }

    // Funzione per aggiornare gli elementi geometrici con le nuove lettere
    function updateShapes() {
      var gameContainer = document.getElementById('game-container');
      gameContainer.innerHTML = '';

      for (var i = 0; i < expectedText.length; i++) {
        var shape = document.createElement('div');
        shape.className = 'shape';
        shape.style.backgroundColor = getRandomColor();
        shape.style.color = 'white';

        var shapeText = document.createElement('span');
        shapeText.textContent = shapesText[i].toUpperCase();
        shape.appendChild(shapeText);

        shape.addEventListener('click', handleTouch);
        gameContainer.appendChild(shape);
      }
    }

    // Chiamata alla funzione per creare gli elementi geometrici quando la pagina Ã¨ pronta
    window.addEventListener('DOMContentLoaded', function() {
      createShapes();

      var linkButton = document.getElementById('link-button');
      linkButton.addEventListener('click', openLink);
    });
  </script>
</body>
</html>
